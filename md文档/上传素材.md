# 上传素材

通过此接口，用户可以上传与广告相关的素材视频。
 **注意**：对于连山 URL 链接上传视频，请及时切换至异步上传接口。

------

## 基本信息

- **请求地址**
   `https://api.oceanengine.com/open_api/2/file/video/ad/`
- **请求方法**
   `POST`
- **Header**

| 字段         | 必填 | 类型   | 描述                                                  |
| ------------ | ---- | ------ | ----------------------------------------------------- |
| Access-Token | 是   | string | 授权 access_token，可通过【获取Access token】接口获取 |
| Content-Type | 是   | string | 请求消息类型，允许值: `multipart/form-data`           |

------

## 请求参数

| 字段            | 类型     | 是否必填 | 描述                                                         |
| --------------- | -------- | -------- | ------------------------------------------------------------ |
| advertiser_id   | number   | 是       | 广告主 ID                                                    |
| upload_type     | string   | 否       | 上传方式：`UPLOAD_BY_FILE`（默认，文件上传）、`UPLOAD_BY_URL`（网址上传） |
| video_signature | string   | 条件必填 | 视频文件的 MD5 值（仅 `UPLOAD_BY_FILE` 有效且必填）          |
| video_file      | file     | 条件必填 | 视频文件，支持 mp4/mpeg/3gp/avi/m4v，≤500M，仅 `UPLOAD_BY_FILE` 有效 |
| filename        | string   | 条件必填 | 素材文件名，仅 `UPLOAD_BY_URL` 有效，可自定义，最长 255 字符 |
| labels          | string[] | 否       | 标签                                                         |
| video_url       | string   | 条件必填 | 视频 URL，仅 `UPLOAD_BY_URL` 必填，必须是连山云 TOS 地址     |
| is_aigc         | bool     | 否       | 是否为 AIGC 生成视频                                         |
| is_guide_video  | bool     | 否       | 是否为引导视频（仅游戏行业白名单客户可用）                   |

------

## 请求示例

```python
# coding=utf-8
import json
import requests
from six.moves.urllib.parse import urlunparse

ACCESS_TOKEN = "xxx"
PATH = "/open_api/2/file/video/ad/"

def build_url(path, query=""):
    scheme, netloc = "https", "api.oceanengine.com"
    return urlunparse((scheme, netloc, path, "", query, ""))

def post(json_str):
    url = build_url(PATH)
    args = json.loads(json_str)
    headers = {
        "Access-Token": ACCESS_TOKEN,
        "Content-Type": "application/json",
    }
    rsp = requests.post(url, headers=headers, json=args)
    return rsp.json()

if __name__ == '__main__':
    advertiser_id = ADVERTISER_ID
    upload_type = UPLOAD_TYPE
    video_signature = VIDEO_SIGNATURE
    video_file = VIDEO_FILE
    filename = FILENAME
    labels_list = LABELS
    labels = json.dumps(labels_list)
    video_url = VIDEO_URL
    is_aigc = IS_AIGC
    is_guide_video = IS_GUIDE_VIDEO

    my_args = "{\"advertiser_id\": \"%s\", \"upload_type\": \"%s\", \"video_signature\": \"%s\", \"video_file\": \"%s\", \"filename\": \"%s\", \"labels\": %s, \"video_url\": \"%s\", \"is_aigc\": \"%s\", \"is_guide_video\": \"%s\"}" % (advertiser_id, upload_type, video_signature, video_file, filename, labels, video_url, is_aigc, is_guide_video)
    print(post(my_args))
```

```curl
curl -H "Access-Token:xxx" -H "Content-Type:application/json" -X POST \
-d '{
    "advertiser_id": "ADVERTISER_ID",
    "upload_type": "UPLOAD_TYPE",
    "video_signature": "VIDEO_SIGNATURE",
    "video_file": "VIDEO_FILE",
    "filename": "FILENAME",
    "labels": [
        "LABELS"
    ],
    "video_url": "VIDEO_URL",
    "is_aigc": "IS_AIGC",
    "is_guide_video": "IS_GUIDE_VIDEO"
}' \
https://api.oceanengine.com/open_api/2/file/video/ad/
```



------



## 应答字段

| 字段            | 类型   | 描述                                        |
| --------------- | ------ | ------------------------------------------- |
| code            | number | 返回码                                      |
| message         | string | 返回信息                                    |
| data            | json   | 返回数据对象                                |
| video_id        | string | 视频 ID                                     |
| size            | number | 视频大小                                    |
| width           | number | 视频宽度                                    |
| height          | number | 视频高度                                    |
| video_url       | string | 视频地址                                    |
| duration        | double | 视频时长                                    |
| material_id     | number | 素材 id（一个视频唯一对应一个 material_id） |
| video_signature | string | 视频 MD5 值                                 |
| request_id      | string | 请求日志 id                                 |

------

## 应答示例

```
{
    "message": "OK",
    "code": 0,
    "data": {}
}
```

------

## 常见错误码

| Code   | Message                  | 解决方案                                                 |
| ------ | ------------------------ | -------------------------------------------------------- |
| 400170 | 部分视频无权限或不存在   | 检查 video_id 是否正确，或等待 2-3 分钟后再操作          |
| 400171 | 视频权限查询失败         | 检查 video_id 是否正确，或等待上传完成后再操作           |
| 400172 | 解析文件失败             | 检查素材 url/文件是否正确，URL 必须是连山云 TOS 地址     |
| 400173 | 视频签名校验失败         | 检查 video_signature 是否与文件 MD5 一致                 |
| 400174 | 部分图片无权限或不存在   | 等待图片上传完成后再操作                                 |
| 400175 | URL 上传仅支持连山云 TOS | 确认视频 URL 是否为连山云 TOS，且区域配置为华北（北京）  |
| 400176 | 主体不一致               | 确认广告投放账户与目标广告主属于同一主体                 |
| 400177 | 文件上传异常             | 检查视频 URL/文件是否可访问                              |
| 400178 | 图片无法解析             | 确认图片 URL 是否可公开访问                              |
| 400179 | 图文素材创建失败         | 检查参数设置是否正确，例如 audio_id 是否存在于当前账户下 |